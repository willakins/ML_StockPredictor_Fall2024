<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Project Proposal</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link href="style.css" rel="stylesheet" type="text/css" />
  </head>
  <body>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
  </body>
  <nav class="navbar navbar-expand-lg bg-body-tertiary">
    <div class="container-fluid">
      <a class="nav-link active" href="#Intro">Introduction</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
          <li class="nav-item">
            <a class="nav-link active" aria-current="page" href="#Problem">Problem Definition</a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" aria-current="page" href="#Methods">Methods</a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" aria-current="page" href="#Results">Results</a>
          </li>
          <li class="nav-item"></li>
            <a class="nav-link active" aria-current="page" href="#Ref">References</a>
          </li>
        </ul>
        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
            
          </ul>
      </div>
    </div>
  </nav>
  <body>
    <div class="grid-container">
      <div class="header">
        <h1>Stock Market Trend Prediction - Midterm Checkpoint</h1>
      </div>
      <div class="left"></div>
      <div class="middle">
        <h2><a id="Intro">Introduction/Background</a></h1>
          <br>
          The stock market is a complex adaptive system, consisting of individual components that interact in response to global events. 
          This makes predicting stock market trends a challenging yet crucial task for investors and financial institutions. 
          The large size of stock market historical data lends itself well to machine learning algorithms; however, no one has been 
          able to create a successful model as historical data is not enough. Others have tried to utilize news sentiment data instead 
          of historical data to make predictions, yet their models still fail. This project takes the unique approach of attempting to 
          combine both historical data and news sentiment in order to develop a machine learning model with the ability to forecast 
          short-term stock price movements for S&P 500 companies.
          <br>
          <br>
          Recent studies have explored various machine learning approaches for stock prediction. Jiang et al. (2021) used LSTM networks 
          for stock price prediction incorporating news sentiment [1]. Patel et al. (2020) compared various machine learning techniques 
          for stock trend prediction [2]. Feng et al. (2019) developed a deep learning framework for stock prediction using technical 
          indicators and textual data [3]. 
          <br>
          We will use a combination of datasets: 
          <ul>
            <li>Yahoo Finance API for historical stock price data of S&P 500 companies</li>
            <li>Alpha Vantage News’ API for real-time and historical financial news articles[3]</li>
          </ul>
          Links to datasets:
          <ul>
            <li>Yahoo Finance: https://finance.yahoo.com</li>
            <li>Alpha Vantage News: https://www.alphavantage.co</li>
          </ul>
          <h2 id="Problem"><a id="Problem">Problem Definition</a></h2>
          Accurate stock market prediction is crucial for optimizing investment strategies, managing financial risks, 
          and understanding market dynamics. The challenge lies in developing a model that can effectively combine numerical 
          time series data with textual sentiment information to predict short-term (1-5 days) stock price movements. <br>
          <h3 id="Methods"><a id="Methods">Data Collection and Preprocessing</a></h3>
          We need two types of data: technical indicators and news articles for our stocks. In order to get technical indicators, 
          we utilized the yahoo finance API. This provided only basic stock details, so we implemented our own functions to 
          calculate more technical indicators for our stock. For news sentiment data, Alpha Vantage news was our source. 
          For each symbol, news articles were retrieved. Their text was cleaned and tokenized. Finally, we compute the sentiment, 
          polarity, and subjectivity of the article as separate features to use in our model. <br>
          <br>
          Once we have obtained the data, we must preprocess it. For this stage of the project we wanted to simplify our data to 
          make debugging our model easier; therefore, PCA was employed. Although the number of features we had before using PCA 
          was not very high, reducing to the most important features did help with improving the visualization of the model.<br>
          <h5>ML Models</h5>
          <ul>
            <li> LSTM Neural Network 
              <ul> <li> Useful for sequential data, this will be ideal for the relation of our data for the forecasting nature of our problem[1].</li></ul>
            </li>
            <li> Random Forest Classifier
              <ul> <li>Multiple decision trees, that outputs the mode, good for when data can be noisy as stocks can.</li></ul>
            </li>
            <li> Support Vector Machine
              <ul> <li>Models used for classification and regression, good for classification of stock trends.</li></ul>
            </li>
          </ul>
          We applied three unique models to our problem to determine what architecture most accurately predicted stock market trends. <br>
	        The first model applied was Long short-term memory or LSTM. LSTM is a type of recurrent neural network (RNN) aimed at mitigating the vanishing gradient problem. 
          LSTM lends itself well to our problem as its memory retention characteristics allows for our model to learn from both short-term fluctuations and long-term trends. <br><br>
	        The second model applied was the Random Forest Classifier. Random Forest is an ensemble learning method that combines multiple decision trees to improve predictive accuracy 
          and reduce overfitting. This model is well-suited for our problem because it can handle a large number of features and capture complex relationships between variables. 
          Its ability to aggregate predictions from numerous trees helps to enhance robustness and accuracy, making it effective for classifying stock market trends where patterns may be influenced by various factors.<br><br>
          The third model applied was the Support Vector Machine (SVM). SVM is a powerful supervised learning algorithm used for classification tasks. It works by finding the optimal hyperplane that separates different classes 
          in the feature space, maximizing the margin between them. SVM is particularly effective for our problem because it can handle high-dimensional data and complex decision boundaries. Its ability to generalize well with a 
          smaller amount of training data makes it suitable for predicting stock market trends, where clear distinctions between price movements are often subtle and nonlinear.
          <br>
          <h3 id="Results"><a id="Results">Results and Discussion</a> </h3>
          <h5>Long Short-Term Memory</h5>
           The first model we are going to discuss is the LSTM model. This model achieved our highest accuracy score of 96%,
           leveraging its ability to remember long-term trends while still focusing on recent movements. The three below graphs 
           illustrate LSTM’s prediction performance over a 200 day period. The y-axis is the cumulative number of positive market days 
           with the red line being our model’s predictions and the blue line being reality. The small margin of difference between 
           reality and our model’s prediction emphasizes our model’s power. However, the model exhibited high error variance 
           indicating inconsistent performance for more volatile stocks. Additionally, LSTM’s reliance on substantial training 
           data and its tendency to overfit to specific patterns poses a challenge for generalization across diverse market conditions.
          <img src="./charts/lstm_AAPL_chart.png"style="width:800px;height:500px;"/>
          <img src="./charts/lstm_GOOG_chart.png"style="width:800px;height:500px;"/>
          <img src="./charts/lstm_MSFT_chart.png"style="width:800px;height:500px;"/>
          <br>
          <h5>Random Forest Classifier</h5>

          The Random Forest Classifier model performed very poorly, with roughly 50% accuracy.
          It classifies stock trends with a 50% accuracy, which means it's about as efficient as flipping a coin.
          This is due to inefficient features being selected. When training the model, we created Permutation Feature 
          Importance (PFI) charts, which show how a model's performance is impacted if we shuffle the values of an individual feature.
          We will also use a confusion matrix, which displays false positives, true negatives, etc., to gauge the accuracy of our upward/downward trend
          classifications. 

          On the first iteration of the model (~50% accurate), we yielded the following charts:
          <img src="./charts/rfc/permutation_feature_importance_1.png" style="width:800px;height:500px;"/>
          <img src="./charts/rfc/confusion_matrix_1.png" />

          According to the PFI chart, MACD, Volatility, and Open were the most importance features, since shuffling values
          negatively impacted the performance of the model. On the contrary,
          SMA5 and SMA20 may have contributed to the model overfitting the data, indicated by the strong negative direction.
          The confusion matrix further shows the inaccuracy of the model, since we could see that the classifications were
          evenly distributed. 

          To try improving the performance of the model, we used the information from the PFI chart
          and removed the SMA5 and SMA20 features. The second iteration of the model (~50% accurate) yielded
          the following charts:
          <img src="./charts/rfc/permutation_feature_importance_2.png" />
          <img src="./charts/rfc/confusion_matrix_2.png" />

          This time, it seems that the only significant feature was MACD, which is concerning. None of the other features
          were significantly affecting the performance of the model. The confusion matrix tells the same story as before.

          Removing more features proves unsuccessful, likely because our model would have too little features.
          The third iteration of the model (~47% accurate) yielded the following charts:
          <img src="./charts/rfc/permutation_feature_importance_3.png" />
          <img src="./charts/rfc/confusion_matrix_3.png" />

          The PFI chart is telling us that ALL the features may be negatively impacting the model. Furthermore,
          the confusion matrix shows a greater sum along the incorrect predictions than the correct predictions.
          <br>
          <br>
          <h5>Support Vector Machine</h5>
          Moving on to a more successful model, SVM had similar but slightly worse performance than LSTM. All three below graphs 
          show a small deviation in the model’s predictions and reality, emphasizing the model’s accuracy, coming out with 
          an average accuracy of around 85 percent. SVM’s ability to handle high dimensional data lended itself well to our 
          financial data, but there were still limitations of this architecture. SVM’s higher RMSE value of around .4 highlights 
          SVM’s limitations to capture temporal dependencies inherent in stock data. Additionally, SVM may struggle with high 
          volatility market conditions, as it lacks sequential learning capabilities unlike the LSTM model. 
          <img src="./charts/svm_AAPL_chart.png"style="width:800px;height:500px;"/>
          <img src="./charts/svm_GOOG_chart.png"style="width:800px;height:500px;"/>
          <img src="./charts/svm_MSFT_chart.png"style="width:800px;height:500px;"/>
          <br>
          <h5>Quantitative Measures</h5>
          <ul>
            <li>Achieve an accuracy of at least 60% in predicting the direction of stock price movements</li>
            <li>Develop a model that outperforms a simple buy-and-hold strategy in terms of Sharpe Ratio (> 1.5)</li>
            <li>Mean Absolute Percentage Error for price predictions (≤ 5%)</li>
            <li>F1 Score, a harmonic mean of precision, for trend classification (≥ 0.65)</li>
          </ul>

          <h5>Next Steps</h5>
          The next steps involve exploring methodologies to combine the strengths of the three discussed models into a unified, 
          hybrid framework. This approach could leverage each model’s unique capabilities—whether in time-series analysis, sentiment 
          interpretation, or classification—creating a more robust and comprehensive solution. Key takeaways include the importance 
          of integrating diverse data sources to improve predictive power, the value of adaptability in model design, and the 
          potential for innovation when merging traditional and advanced techniques. This endeavor highlights the broader goal 
          of creating scalable and holistic systems for tackling complex real-world problems.
          <h3 id = "Ref"> <a id="Ref">References</a></h3>
          [1] J. Li, G. Li, M. Liu, X. Zhu, and L. Wei,
          “A novel text-based framework for forecasting agricultural futures using massive online news headlines,
          ”International Journal of Forecasting, vol. 38, no. 1, pp. 35–50, Jan. 2022, doi: https://doi.org/10.1016/j.ijforecast.2020.02.002. <br>  
          [2] J. Patel, S. Shah, P. Thakkar, and K. Kotecha,
          “Predicting stock and stock price index movement using Trend Deterministic Data Preparation and machine learning techniques,
          ”Expert Systems with Applications, vol. 42, no. 1, pp. 259–268, Jan. 2015,doi: https://doi.org/10.1016/j.eswa.2014.07.040. <br>
          [3] F. Feng, H. Chen, X. He, J. Ding, M. Sun, and T.-S. Chua, “Enhancing Stock Movement Prediction with Adversarial Training,” arXiv.org, Jun. 01, 2019. https://arxiv.org/abs/1810.09936v2
          <h3> Gantt Chart</h3>
          <img src = "GanttChart.png" alt = "Gantt Chart" style="width:1000px;height:500px;"> <br>
          <h3> Contribution Chart</h3>
          <img src="Contribution.png" alt ="Contribution Chart">
      </div>
      <div class="right"></div>
    </div>
  </body>
</html>