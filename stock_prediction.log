2024-12-03 19:59:11,701 - INFO - === Starting Enhanced Stock Prediction Model Pipeline ===
2024-12-03 19:59:11,701 - INFO - Loading preprocessed data...
2024-12-03 19:59:11,716 - INFO - 
Processed AAPL:
2024-12-03 19:59:11,716 - INFO - Stock PCA shape: (1006, 5)
2024-12-03 19:59:11,716 - INFO - News PCA shape: (50, 1)
2024-12-03 19:59:11,716 - INFO - Combined shape: (1006, 8)
2024-12-03 19:59:11,724 - INFO - 
Processed GOOG:
2024-12-03 19:59:11,724 - INFO - Stock PCA shape: (1006, 5)
2024-12-03 19:59:11,725 - INFO - News PCA shape: (50, 1)
2024-12-03 19:59:11,725 - INFO - Combined shape: (1006, 8)
2024-12-03 19:59:11,735 - INFO - 
Processed MSFT:
2024-12-03 19:59:11,736 - INFO - Stock PCA shape: (1006, 5)
2024-12-03 19:59:11,736 - INFO - News PCA shape: (50, 1)
2024-12-03 19:59:11,736 - INFO - Combined shape: (1006, 8)
2024-12-03 19:59:11,736 - INFO - 
Final combined shape: (3018, 8)
2024-12-03 19:59:11,736 - INFO - Analyzing data distribution...
2024-12-03 19:59:11,739 - INFO - 
Overall class distribution:
Target
1    0.529821
0    0.470179
Name: proportion, dtype: float64
2024-12-03 19:59:11,749 - INFO - 
Class distribution by stock:
Target         0         1
Ticker                    
AAPL    0.475149  0.524851
GOOG    0.461233  0.538767
MSFT    0.474155  0.525845
2024-12-03 19:59:11,750 - INFO - 
Missing values:
PC1_stock       0
PC2_stock       0
PC3_stock       0
PC4_stock       0
PC5_stock       0
PC1_news     2868
Target          0
Ticker          0
dtype: int64
2024-12-03 19:59:12,296 - INFO - Preparing features from PCA components...
2024-12-03 19:59:12,297 - WARNING - Found missing values in features, filling with forward fill
2024-12-03 19:59:12,298 - INFO - Features used: ['PC1_stock', 'PC2_stock', 'PC3_stock', 'PC4_stock', 'PC5_stock', 'PC1_news']
2024-12-03 19:59:12,298 - INFO - Training set shape: (2414, 6)
2024-12-03 19:59:12,298 - INFO - Test set shape: (604, 6)
2024-12-03 19:59:12,299 - INFO - Class distribution in training set:
Target
1    0.534797
0    0.465203
Name: proportion, dtype: float64
2024-12-03 19:59:12,299 - INFO - Training Random Forest model with optimized parameters...
2024-12-03 20:00:04,858 - INFO - Best parameters found: {'n_estimators': 500, 'min_samples_split': 8, 'min_samples_leaf': 1, 'max_samples': 0.8, 'max_features': 'sqrt', 'max_depth': 25, 'class_weight': {0: 1.5, 1: 1}, 'bootstrap': True}
2024-12-03 20:00:04,956 - INFO - Optimal threshold found: 0.380
2024-12-03 20:00:04,982 - INFO - Out-of-bag score: 0.7444
2024-12-03 20:00:05,917 - INFO - 
=== Model Performance Metrics ===
2024-12-03 20:00:05,917 - INFO - 
Classification Metrics:
2024-12-03 20:00:05,917 - INFO - Accuracy:     0.5828
2024-12-03 20:00:05,917 - INFO - Precision:    0.5532
2024-12-03 20:00:05,917 - INFO - Recall:       0.9448
2024-12-03 20:00:05,917 - INFO - F1 Score:     0.6978
2024-12-03 20:00:05,917 - INFO - ROC AUC:      0.7097
2024-12-03 20:00:05,917 - INFO - 
Prediction Error:
2024-12-03 20:00:05,917 - INFO - Weighted MAPE: 45.26%
2024-12-03 20:00:05,917 - INFO - 
Confidence-based Metrics:
2024-12-03 20:00:05,917 - INFO - Confidence â‰¥0.6:
2024-12-03 20:00:05,917 - INFO -   Accuracy: 1.0000
2024-12-03 20:00:05,917 - INFO -   % of Predictions: 0.2%
2024-12-03 20:00:05,917 - INFO - 
Cross-validation Metrics:
2024-12-03 20:00:05,917 - INFO - CV F1 Mean:   0.6091
2024-12-03 20:00:05,917 - INFO - CV F1 Std:    0.1622
2024-12-03 20:00:07,000 - INFO - === Pipeline Completed ===
2024-12-03 20:30:04,527 - INFO - === Starting Enhanced Stock Prediction Model Pipeline ===
2024-12-03 20:30:04,527 - INFO - Loading preprocessed data...
2024-12-03 20:30:04,546 - INFO - 
Processed AAPL:
2024-12-03 20:30:04,546 - INFO - Stock PCA shape: (1006, 5)
2024-12-03 20:30:04,546 - INFO - News PCA shape: (50, 1)
2024-12-03 20:30:04,546 - INFO - Combined shape: (1006, 8)
2024-12-03 20:30:04,565 - INFO - 
Processed GOOG:
2024-12-03 20:30:04,565 - INFO - Stock PCA shape: (1006, 5)
2024-12-03 20:30:04,565 - INFO - News PCA shape: (50, 1)
2024-12-03 20:30:04,565 - INFO - Combined shape: (1006, 8)
2024-12-03 20:30:04,578 - INFO - 
Processed MSFT:
2024-12-03 20:30:04,578 - INFO - Stock PCA shape: (1006, 5)
2024-12-03 20:30:04,578 - INFO - News PCA shape: (50, 1)
2024-12-03 20:30:04,578 - INFO - Combined shape: (1006, 8)
2024-12-03 20:30:04,579 - INFO - 
Final combined shape: (3018, 8)
2024-12-03 20:30:04,579 - INFO - Analyzing data distribution...
2024-12-03 20:30:04,584 - INFO - 
Overall class distribution:
Target
1    0.529821
0    0.470179
Name: proportion, dtype: float64
2024-12-03 20:30:04,601 - INFO - 
Class distribution by stock:
Target         0         1
Ticker                    
AAPL    0.475149  0.524851
GOOG    0.461233  0.538767
MSFT    0.474155  0.525845
2024-12-03 20:30:04,604 - INFO - 
Missing values:
PC1_stock       0
PC2_stock       0
PC3_stock       0
PC4_stock       0
PC5_stock       0
PC1_news     2868
Target          0
Ticker          0
dtype: int64
2024-12-03 20:30:05,054 - INFO - Preparing features from PCA components...
2024-12-03 20:30:05,055 - WARNING - Found missing values in features, filling with forward fill
2024-12-03 20:30:05,056 - INFO - Features used: ['PC1_stock', 'PC2_stock', 'PC3_stock', 'PC4_stock', 'PC5_stock', 'PC1_news']
2024-12-03 20:30:05,056 - INFO - Training set shape: (2414, 6)
2024-12-03 20:30:05,056 - INFO - Test set shape: (604, 6)
2024-12-03 20:30:05,057 - INFO - Class distribution in training set:
Target
1    0.534797
0    0.465203
Name: proportion, dtype: float64
2024-12-03 20:30:05,057 - INFO - Training Random Forest model with optimized parameters...
2024-12-03 20:31:05,078 - INFO - Best parameters found: {'n_estimators': 500, 'min_samples_split': 8, 'min_samples_leaf': 1, 'max_samples': 0.8, 'max_features': 'sqrt', 'max_depth': 25, 'class_weight': {0: 1.5, 1: 1}, 'bootstrap': True}
2024-12-03 20:31:05,172 - INFO - Optimal threshold found: 0.380
2024-12-03 20:31:05,197 - INFO - Out-of-bag score: 0.7444
2024-12-03 20:31:05,198 - ERROR - Pipeline failed: 'Ticker'
2024-12-03 20:31:05,198 - INFO - === Pipeline Completed ===
2024-12-03 20:31:05,198 - ERROR - Application failed: 'Ticker'
2024-12-03 20:32:59,687 - INFO - === Starting Enhanced Stock Prediction Model Pipeline ===
2024-12-03 20:32:59,687 - INFO - Loading preprocessed data...
2024-12-03 20:32:59,709 - INFO - 
Processed AAPL:
2024-12-03 20:32:59,710 - INFO - Stock PCA shape: (1006, 5)
2024-12-03 20:32:59,710 - INFO - News PCA shape: (50, 1)
2024-12-03 20:32:59,710 - INFO - Combined shape: (1006, 8)
2024-12-03 20:32:59,720 - INFO - 
Processed GOOG:
2024-12-03 20:32:59,720 - INFO - Stock PCA shape: (1006, 5)
2024-12-03 20:32:59,720 - INFO - News PCA shape: (50, 1)
2024-12-03 20:32:59,720 - INFO - Combined shape: (1006, 8)
2024-12-03 20:32:59,731 - INFO - 
Processed MSFT:
2024-12-03 20:32:59,731 - INFO - Stock PCA shape: (1006, 5)
2024-12-03 20:32:59,731 - INFO - News PCA shape: (50, 1)
2024-12-03 20:32:59,731 - INFO - Combined shape: (1006, 8)
2024-12-03 20:32:59,731 - INFO - 
Final combined shape: (3018, 8)
2024-12-03 20:32:59,731 - INFO - Analyzing data distribution...
2024-12-03 20:32:59,739 - INFO - 
Overall class distribution:
Target
1    0.529821
0    0.470179
Name: proportion, dtype: float64
2024-12-03 20:32:59,765 - INFO - 
Class distribution by stock:
Target         0         1
Ticker                    
AAPL    0.475149  0.524851
GOOG    0.461233  0.538767
MSFT    0.474155  0.525845
2024-12-03 20:32:59,767 - INFO - 
Missing values:
PC1_stock       0
PC2_stock       0
PC3_stock       0
PC4_stock       0
PC5_stock       0
PC1_news     2868
Target          0
Ticker          0
dtype: int64
2024-12-03 20:33:00,217 - INFO - Preparing features from PCA components...
2024-12-03 20:33:00,217 - WARNING - Found missing values in features, filling with forward fill
2024-12-03 20:33:00,219 - INFO - Features used: ['PC1_stock', 'PC2_stock', 'PC3_stock', 'PC4_stock', 'PC5_stock', 'PC1_news']
2024-12-03 20:33:00,219 - INFO - Training set shape: (2414, 6)
2024-12-03 20:33:00,219 - INFO - Test set shape: (604, 6)
2024-12-03 20:33:00,219 - INFO - Class distribution in training set:
Target
1    0.534797
0    0.465203
Name: proportion, dtype: float64
2024-12-03 20:33:00,219 - INFO - Training Random Forest model with optimized parameters...
2024-12-03 20:33:51,958 - INFO - Best parameters found: {'n_estimators': 500, 'min_samples_split': 8, 'min_samples_leaf': 1, 'max_samples': 0.8, 'max_features': 'sqrt', 'max_depth': 25, 'class_weight': {0: 1.5, 1: 1}, 'bootstrap': True}
2024-12-03 20:33:52,063 - INFO - Optimal threshold found: 0.380
2024-12-03 20:33:52,091 - INFO - Out-of-bag score: 0.7444
2024-12-03 20:33:52,092 - ERROR - Pipeline failed: Can only use .str accessor with string values!
2024-12-03 20:33:52,092 - INFO - === Pipeline Completed ===
2024-12-03 20:33:52,092 - ERROR - Application failed: Can only use .str accessor with string values!
2024-12-03 20:35:52,256 - INFO - === Starting Enhanced Stock Prediction Model Pipeline ===
2024-12-03 20:35:52,269 - INFO - Loading preprocessed data...
2024-12-03 20:35:52,294 - INFO - 
Processed AAPL:
2024-12-03 20:35:52,294 - INFO - Stock PCA shape: (1006, 5)
2024-12-03 20:35:52,294 - INFO - News PCA shape: (50, 1)
2024-12-03 20:35:52,294 - INFO - Combined shape: (1006, 8)
2024-12-03 20:35:52,304 - INFO - 
Processed GOOG:
2024-12-03 20:35:52,304 - INFO - Stock PCA shape: (1006, 5)
2024-12-03 20:35:52,304 - INFO - News PCA shape: (50, 1)
2024-12-03 20:35:52,304 - INFO - Combined shape: (1006, 8)
2024-12-03 20:35:52,318 - INFO - 
Processed MSFT:
2024-12-03 20:35:52,318 - INFO - Stock PCA shape: (1006, 5)
2024-12-03 20:35:52,318 - INFO - News PCA shape: (50, 1)
2024-12-03 20:35:52,318 - INFO - Combined shape: (1006, 8)
2024-12-03 20:35:52,319 - INFO - 
Final combined shape: (3018, 8)
2024-12-03 20:35:52,323 - INFO - Analyzing data distribution...
2024-12-03 20:35:52,326 - INFO - 
Overall class distribution:
Target
1    0.529821
0    0.470179
Name: proportion, dtype: float64
2024-12-03 20:35:52,336 - INFO - 
Class distribution by stock:
Target         0         1
Ticker                    
AAPL    0.475149  0.524851
GOOG    0.461233  0.538767
MSFT    0.474155  0.525845
2024-12-03 20:35:52,338 - INFO - 
Missing values:
PC1_stock       0
PC2_stock       0
PC3_stock       0
PC4_stock       0
PC5_stock       0
PC1_news     2868
Target          0
Ticker          0
dtype: int64
2024-12-03 20:35:52,762 - INFO - Preparing features from PCA components...
2024-12-03 20:35:52,762 - WARNING - Found missing values in features, filling with forward fill
2024-12-03 20:35:52,764 - INFO - Features used: ['PC1_stock', 'PC2_stock', 'PC3_stock', 'PC4_stock', 'PC5_stock', 'PC1_news']
2024-12-03 20:35:52,764 - INFO - Training set shape: (2414, 6)
2024-12-03 20:35:52,764 - INFO - Test set shape: (604, 6)
2024-12-03 20:35:52,765 - INFO - Class distribution in training set:
Target
1    0.534797
0    0.465203
Name: proportion, dtype: float64
2024-12-03 20:35:52,765 - INFO - Training Random Forest model with optimized parameters...
2024-12-03 20:36:44,775 - INFO - Best parameters found: {'n_estimators': 500, 'min_samples_split': 8, 'min_samples_leaf': 1, 'max_samples': 0.8, 'max_features': 'sqrt', 'max_depth': 25, 'class_weight': {0: 1.5, 1: 1}, 'bootstrap': True}
2024-12-03 20:36:44,882 - INFO - Optimal threshold found: 0.380
2024-12-03 20:36:44,919 - INFO - Out-of-bag score: 0.7444
2024-12-03 20:36:44,926 - INFO - 
=== Per-Stock Performance Metrics ===
2024-12-03 20:36:44,926 - INFO - 
=== Overall Performance Metrics ===
2024-12-03 20:36:44,926 - INFO - Overall - MAPE: 46.17%, RMSE: 0.47, Accuracy: 0.5828, F1 Score: 0.6978
2024-12-03 20:36:45,997 - INFO - === Pipeline Completed ===
2024-12-03 20:38:51,306 - INFO - === Starting Enhanced Stock Prediction Model Pipeline ===
2024-12-03 20:38:51,306 - INFO - Loading preprocessed data...
2024-12-03 20:38:51,323 - INFO - 
Processed AAPL:
2024-12-03 20:38:51,323 - INFO - Stock PCA shape: (1006, 5)
2024-12-03 20:38:51,323 - INFO - News PCA shape: (50, 1)
2024-12-03 20:38:51,323 - INFO - Combined shape: (1006, 8)
2024-12-03 20:38:51,340 - INFO - 
Processed GOOG:
2024-12-03 20:38:51,340 - INFO - Stock PCA shape: (1006, 5)
2024-12-03 20:38:51,340 - INFO - News PCA shape: (50, 1)
2024-12-03 20:38:51,340 - INFO - Combined shape: (1006, 8)
2024-12-03 20:38:51,356 - INFO - 
Processed MSFT:
2024-12-03 20:38:51,356 - INFO - Stock PCA shape: (1006, 5)
2024-12-03 20:38:51,356 - INFO - News PCA shape: (50, 1)
2024-12-03 20:38:51,356 - INFO - Combined shape: (1006, 8)
2024-12-03 20:38:51,357 - INFO - 
Final combined shape: (3018, 8)
2024-12-03 20:38:51,357 - INFO - Analyzing data distribution...
2024-12-03 20:38:51,360 - INFO - 
Overall class distribution:
Target
1    0.529821
0    0.470179
Name: proportion, dtype: float64
2024-12-03 20:38:51,368 - INFO - 
Class distribution by stock:
Target         0         1
Ticker                    
AAPL    0.475149  0.524851
GOOG    0.461233  0.538767
MSFT    0.474155  0.525845
2024-12-03 20:38:51,369 - INFO - 
Missing values:
PC1_stock       0
PC2_stock       0
PC3_stock       0
PC4_stock       0
PC5_stock       0
PC1_news     2868
Target          0
Ticker          0
dtype: int64
2024-12-03 20:38:51,903 - INFO - Training Random Forest model with optimized parameters...
2024-12-03 20:39:50,125 - INFO - Best parameters found: {'n_estimators': 500, 'min_samples_split': 8, 'min_samples_leaf': 1, 'max_samples': 0.8, 'max_features': 'sqrt', 'max_depth': 25, 'class_weight': {0: 1.5, 1: 1}, 'bootstrap': True}
2024-12-03 20:39:50,222 - INFO - Optimal threshold found: 0.300
2024-12-03 20:39:50,269 - INFO - Out-of-bag score: 0.6893
2024-12-03 20:39:50,272 - INFO - 
=== Per-Stock Performance Metrics ===
2024-12-03 20:39:50,273 - INFO - MSFT - MAPE: 60.68%, RMSE: 0.64, Accuracy: 0.3593, F1 Score: 0.4941
2024-12-03 20:39:51,346 - INFO - === Pipeline Completed ===
2024-12-03 20:41:00,353 - INFO - === Starting Enhanced Stock Prediction Model Pipeline ===
2024-12-03 20:41:00,353 - INFO - Loading preprocessed data...
2024-12-03 20:41:00,375 - INFO - 
Processed AAPL:
2024-12-03 20:41:00,375 - INFO - Stock PCA shape: (1006, 5)
2024-12-03 20:41:00,375 - INFO - News PCA shape: (50, 1)
2024-12-03 20:41:00,375 - INFO - Combined shape: (1006, 8)
2024-12-03 20:41:00,389 - INFO - 
Processed GOOG:
2024-12-03 20:41:00,389 - INFO - Stock PCA shape: (1006, 5)
2024-12-03 20:41:00,389 - INFO - News PCA shape: (50, 1)
2024-12-03 20:41:00,389 - INFO - Combined shape: (1006, 8)
2024-12-03 20:41:00,400 - INFO - 
Processed MSFT:
2024-12-03 20:41:00,400 - INFO - Stock PCA shape: (1006, 5)
2024-12-03 20:41:00,400 - INFO - News PCA shape: (50, 1)
2024-12-03 20:41:00,400 - INFO - Combined shape: (1006, 8)
2024-12-03 20:41:00,400 - INFO - 
Final combined shape: (3018, 8)
2024-12-03 20:41:00,400 - INFO - Analyzing data distribution...
2024-12-03 20:41:00,402 - INFO - 
Overall class distribution:
Target
1    0.529821
0    0.470179
Name: proportion, dtype: float64
2024-12-03 20:41:00,409 - INFO - 
Class distribution by stock:
Target         0         1
Ticker                    
AAPL    0.475149  0.524851
GOOG    0.461233  0.538767
MSFT    0.474155  0.525845
2024-12-03 20:41:00,410 - INFO - 
Missing values:
PC1_stock       0
PC2_stock       0
PC3_stock       0
PC4_stock       0
PC5_stock       0
PC1_news     2868
Target          0
Ticker          0
dtype: int64
2024-12-03 20:41:00,856 - INFO - Training Random Forest model with optimized parameters...
2024-12-03 20:41:53,759 - INFO - Best parameters found: {'n_estimators': 500, 'min_samples_split': 8, 'min_samples_leaf': 1, 'max_samples': 0.8, 'max_features': 'sqrt', 'max_depth': 25, 'class_weight': {0: 1.5, 1: 1}, 'bootstrap': True}
2024-12-03 20:41:53,878 - INFO - Optimal threshold found: 0.300
2024-12-03 20:41:53,903 - INFO - Out-of-bag score: 0.6893
2024-12-03 20:41:53,904 - INFO - 
=== Per-Stock Performance Metrics ===
2024-12-03 20:41:53,905 - INFO - MSFT - MAPE: 60.68%, RMSE: 0.64, Accuracy: 0.3593, F1 Score: 0.4941
2024-12-03 20:41:54,892 - INFO - === Pipeline Completed ===
2024-12-03 20:44:17,452 - INFO - === Starting Enhanced Stock Prediction Model Pipeline ===
2024-12-03 20:44:17,452 - INFO - Loading preprocessed data...
2024-12-03 20:44:17,465 - INFO - Processed AAPL - Shape: (1006, 10)
2024-12-03 20:44:17,477 - INFO - Processed GOOG - Shape: (1006, 10)
2024-12-03 20:44:17,486 - INFO - Processed MSFT - Shape: (1006, 10)
2024-12-03 20:44:17,487 - INFO - Final combined shape: (3018, 10)
2024-12-03 20:44:17,487 - INFO - Analyzing data distribution...
2024-12-03 20:44:17,494 - INFO - 
Overall class distribution:
Target
1    0.529821
0    0.470179
Name: proportion, dtype: float64
2024-12-03 20:44:17,505 - INFO - 
Class distribution by stock:
Target         0         1
Ticker                    
AAPL    0.475149  0.524851
GOOG    0.461233  0.538767
MSFT    0.474155  0.525845
2024-12-03 20:44:17,506 - INFO - 
Missing values:
Unnamed: 0       0
PC1_stock        0
PC2_stock        0
PC3_stock        0
PC4_stock        0
PC5_stock        0
Unnamed: 0    2868
PC1_news      2868
Target           0
Ticker           0
dtype: int64
2024-12-03 20:44:17,997 - INFO - Training Random Forest model with optimized parameters...
2024-12-03 20:45:19,939 - INFO - Best parameters found: {'n_estimators': 500, 'min_samples_split': 8, 'min_samples_leaf': 1, 'max_samples': 0.8, 'max_features': 'sqrt', 'max_depth': 25, 'class_weight': {0: 1.5, 1: 1}, 'bootstrap': True}
2024-12-03 20:45:20,047 - INFO - Optimal threshold found: 0.300
2024-12-03 20:45:20,084 - INFO - Out-of-bag score: 0.6893
2024-12-03 20:45:20,086 - INFO - 
=== Per-Stock Performance Metrics ===
2024-12-03 20:45:20,086 - INFO - MSFT - MAPE: 60.68%, RMSE: 0.64, Accuracy: 0.3593, F1 Score: 0.4941
2024-12-03 20:45:21,084 - INFO - === Pipeline Completed ===
2024-12-03 20:47:45,787 - INFO - === Starting Enhanced Stock Prediction Model Pipeline ===
2024-12-03 20:47:45,787 - INFO - Loading preprocessed data...
2024-12-03 20:47:45,802 - INFO - Processed AAPL - Shape: (1006, 10)
2024-12-03 20:47:45,813 - INFO - Processed GOOG - Shape: (1006, 10)
2024-12-03 20:47:45,842 - INFO - Processed MSFT - Shape: (1006, 10)
2024-12-03 20:47:45,843 - INFO - Final combined shape: (3018, 10)
2024-12-03 20:47:45,843 - INFO - Analyzing data distribution...
2024-12-03 20:47:45,857 - INFO - 
Overall class distribution:
Target
1    0.529821
0    0.470179
Name: proportion, dtype: float64
2024-12-03 20:47:45,874 - INFO - 
Class distribution by stock:
Target         0         1
Ticker                    
AAPL    0.475149  0.524851
GOOG    0.461233  0.538767
MSFT    0.474155  0.525845
2024-12-03 20:47:45,875 - INFO - 
Missing values:
Unnamed: 0       0
PC1_stock        0
PC2_stock        0
PC3_stock        0
PC4_stock        0
PC5_stock        0
Unnamed: 0    2868
PC1_news      2868
Target           0
Ticker           0
dtype: int64
2024-12-03 20:47:46,365 - INFO - Training Random Forest model with optimized parameters...
2024-12-03 20:48:41,150 - INFO - Best parameters found: {'n_estimators': 500, 'min_samples_split': 8, 'min_samples_leaf': 1, 'max_samples': 0.8, 'max_features': 'sqrt', 'max_depth': 25, 'class_weight': {0: 1.5, 1: 1}, 'bootstrap': True}
2024-12-03 20:48:41,260 - INFO - Optimal threshold found: 0.300
2024-12-03 20:48:41,286 - INFO - Out-of-bag score: 0.6893
2024-12-03 20:48:41,286 - INFO - 
=== Per-Stock Performance Metrics ===
2024-12-03 20:48:41,287 - INFO - MSFT - MAPE: 60.68%, RMSE: 0.64, Accuracy: 0.3593, F1 Score: 0.4941
2024-12-03 20:48:42,205 - INFO - === Pipeline Completed ===
2024-12-03 20:50:44,490 - INFO - === Starting Enhanced Stock Prediction Model Pipeline ===
2024-12-03 20:50:44,490 - INFO - Loading preprocessed data...
2024-12-03 20:50:44,537 - INFO - Analyzing data distribution...
2024-12-03 20:50:44,538 - INFO - 
Overall class distribution:
Target
1    0.529821
0    0.470179
Name: proportion, dtype: float64
2024-12-03 20:50:44,546 - INFO - 
Class distribution by stock:
Target         0         1
Ticker                    
AAPL    0.475149  0.524851
GOOG    0.461233  0.538767
MSFT    0.474155  0.525845
2024-12-03 20:50:44,547 - INFO - 
Missing values:
PC1_stock       0
PC2_stock       0
PC3_stock       0
PC4_stock       0
PC5_stock       0
PC1_news     2868
Target          0
Ticker          0
dtype: int64
2024-12-03 20:50:44,968 - INFO - Training Random Forest model with optimized parameters...
2024-12-03 20:51:45,946 - INFO - Best parameters found: {'n_estimators': 500, 'min_samples_split': 8, 'min_samples_leaf': 1, 'max_samples': 0.8, 'max_features': 'sqrt', 'max_depth': 25, 'class_weight': {0: 1.5, 1: 1}, 'bootstrap': True}
2024-12-03 20:51:46,052 - INFO - Optimal threshold found: 0.340
2024-12-03 20:51:46,089 - INFO - Out-of-bag score: 0.6454
2024-12-03 20:51:46,089 - INFO - 
=== Per-Stock Performance Metrics ===
2024-12-03 20:51:46,090 - INFO - AAPL - MAPE: 46.40%, RMSE: 0.48, Accuracy: 0.6250, F1 Score: 0.7387
2024-12-03 20:51:46,091 - INFO - GOOG - MAPE: 43.73%, RMSE: 0.46, Accuracy: 0.6436, F1 Score: 0.7447
2024-12-03 20:51:46,092 - INFO - MSFT - MAPE: 53.02%, RMSE: 0.54, Accuracy: 0.5446, F1 Score: 0.6974
2024-12-03 20:51:47,252 - INFO - === Pipeline Completed ===
